#!/bin/bash
# getgnm  - Gets a week's worth of cryptics from the Globe and Mail

set -x
baseurl="https://xwords.net/xwordjs/files/html5/"
#Simply Daily are at:
### http://simplydailypuzzles.com/daily-cryptic/puzzles/yyyy-mm/
#and Chambers are at:
###https://chambers.co.uk/wp-content/uploads/2018/12/ChambersDec18.js
num=$1

for (( i=0; i<6; num++, i++ )); do
    # Get the file
    file=${num}crp.js
    wget --wait=3 --random-wait $baseurl/$file

    # Convert it from javascript to xml
    perl -pi -e 's/var CrosswordPuzzleData = "//;' $file
    perl -pi -e 's/\\"/"/g;' $file
    perl -pi -e 's/";//g;' $file
    
    # Convert it to puz
    ./xml2puz $num
done
